{{define "content"}}
<div class="page-header">
    <div class="page-header-content">
        <h1>Manage Users</h1>
        <p class="text-muted">Create and manage user accounts</p>
    </div>
    <a href="/admin/users/new" class="btn btn-primary">Add User</a>
</div>

{{if .Users}}
<div class="table-container">
    <table class="table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Day Progress</th>
                <th>Night Progress</th>
                <th>Total Hours</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {{range .Users}}
            <tr>
                <td>{{.Name}}</td>
                <td>{{.Email}}</td>
                <td>
                    {{if .IsAdmin}}
                    <span class="badge badge-admin">Admin</span>
                    {{else}}
                    <span class="badge badge-driver">Driver</span>
                    {{end}}
                </td>
                {{if .IsDriver}}
                <td>
                    <div class="progress-bar-inline">
                        <div class="progress-fill" style="width: {{.DayProgress}}%"></div>
                    </div>
                    <span class="progress-text">{{formatDecimal .TotalDayHours}}/{{formatDecimal .RequiredDayHours}}h</span>
                </td>
                <td>
                    <div class="progress-bar-inline">
                        <div class="progress-fill night" style="width: {{.NightProgress}}%"></div>
                    </div>
                    <span class="progress-text">{{formatDecimal .TotalNightHours}}/{{formatDecimal .RequiredNightHours}}h</span>
                </td>
                <td>{{formatHours .TotalHours}}</td>
                {{else}}
                <td colspan="3" class="text-muted">N/A</td>
                {{end}}
                <td class="actions">
                    {{if .IsDriver}}
                    <a href="/admin/users/{{.ID}}" class="btn btn-secondary btn-xs">View</a>
                    {{end}}
                    <a href="/admin/users/{{.ID}}/edit" class="btn btn-secondary btn-xs">Edit</a>
                    {{if .IsDriver}}
                    <a href="/admin/users/{{.ID}}/hours" class="btn btn-secondary btn-xs">Hours</a>
                    {{end}}
                    <form method="POST" action="/admin/users/{{.ID}}/delete" style="display:inline" onsubmit="return confirm('Are you sure you want to delete this user?');">
                        {{$.CSRFField}}
                        <button type="submit" class="btn btn-danger btn-xs">Delete</button>
                    </form>
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>
{{else}}
<div class="empty-state">
    <p>No users yet.</p>
    <a href="/admin/users/new" class="btn btn-primary">Add User</a>
</div>
{{end}}
{{end}}
